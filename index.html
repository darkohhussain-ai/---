<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ashley HomeStore - شوێنکەوتنی خەرجییەکان</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;700&display=swap');
    body {
      font-family: 'Noto Sans Arabic', Arial, sans-serif;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const Plus = () => (
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
    );

    const Trash2 = ({ size = 20 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <polyline points="3 6 5 6 21 6"></polyline>
        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
      </svg>
    );

    const Download = ({ size = 20 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7 10 12 15 17 10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
      </svg>
    );

    const Printer = ({ size = 20 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <polyline points="6 9 6 2 18 2 18 9"></polyline>
        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
        <rect x="6" y="14" width="12" height="8"></rect>
      </svg>
    );

    const Settings = ({ size = 20 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <circle cx="12" cy="12" r="3"></circle>
        <path d="M12 1v6m0 6v6m8.66-15l-5.2 3m-2.92 1.73l-5.2 3M23 12h-6m-6 0H1m19.07 7l-5.2-3m-2.94-1.73l-5.2-3"></path>
      </svg>
    );

    const UserPlus = ({ size = 20 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
        <circle cx="8.5" cy="7" r="4"></circle>
        <line x1="20" y1="8" x2="20" y2="14"></line>
        <line x1="23" y1="11" x2="17" y2="11"></line>
      </svg>
    );

    const X = ({ size = 20 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    );

    function ExpenseTracker() {
      const [expenses, setExpenses] = useState([]);
      const [employees, setEmployees] = useState([]);
      const [showEmployeeModal, setShowEmployeeModal] = useState(false);
      const [newEmployeeName, setNewEmployeeName] = useState('');
      const [formData, setFormData] = useState({
        employeeName: '',
        date: new Date().toISOString().split('T')[0],
        amount: '',
        note: ''
      });

      useEffect(() => {
        loadExpenses();
        loadEmployees();
      }, []);

      const loadExpenses = () => {
        try {
          const data = localStorage.getItem('ashley-expenses');
          if (data) {
            setExpenses(JSON.parse(data));
          }
        } catch (error) {
          console.log('No existing data found');
        }
      };

      const loadEmployees = () => {
        try {
          const data = localStorage.getItem('ashley-employees');
          if (data) {
            setEmployees(JSON.parse(data));
          }
        } catch (error) {
          console.log('No employees found');
        }
      };

      const saveExpenses = (newExpenses) => {
        try {
          localStorage.setItem('ashley-expenses', JSON.stringify(newExpenses));
        } catch (error) {
          console.error('Error saving:', error);
        }
      };

      const saveEmployees = (newEmployees) => {
        try {
          localStorage.setItem('ashley-employees', JSON.stringify(newEmployees));
        } catch (error) {
          console.error('Error saving employees:', error);
        }
      };

      const handleAddEmployee = () => {
        if (!newEmployeeName.trim()) {
          alert('تکایە ناوی کارمەند بنووسە');
          return;
        }
        if (employees.includes(newEmployeeName.trim())) {
          alert('ئەم ناوە پێشتر زیادکراوە');
          return;
        }
        const updated = [...employees, newEmployeeName.trim()];
        setEmployees(updated);
        saveEmployees(updated);
        setNewEmployeeName('');
      };

      const handleRemoveEmployee = (name) => {
        if (confirm(`دڵنیای لە سڕینەوەی ${name}?`)) {
          const updated = employees.filter(emp => emp !== name);
          setEmployees(updated);
          saveEmployees(updated);
        }
      };

      const handleSubmit = () => {
        if (!formData.employeeName || !formData.amount) {
          alert('تکایە ناوی کارمەند و بڕی پارە بنووسە');
          return;
        }

        const newExpense = {
          id: Date.now(),
          ...formData,
          amount: parseFloat(formData.amount)
        };

        const updated = [...expenses, newExpense];
        setExpenses(updated);
        saveExpenses(updated);

        setFormData({
          employeeName: '',
          date: new Date().toISOString().split('T')[0],
          amount: '',
          note: ''
        });
      };

      const deleteExpense = (id) => {
        const updated = expenses.filter(exp => exp.id !== id);
        setExpenses(updated);
        saveExpenses(updated);
      };

      const groupedExpenses = expenses.reduce((acc, exp) => {
        if (!acc[exp.employeeName]) {
          acc[exp.employeeName] = [];
        }
        acc[exp.employeeName].push(exp);
        return acc;
      }, {});

      const employeeTotals = Object.keys(groupedExpenses).map(name => ({
        name,
        total: groupedExpenses[name].reduce((sum, exp) => sum + exp.amount, 0)
      }));

      const grandTotal = expenses.reduce((sum, exp) => sum + exp.amount, 0);

      const generateHTMLReport = () => {
        let html = `<!DOCTYPE html>
<html dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ashley HomeStore - ڕاپۆرتی خەرجییەکان</title>
  <style>
    @page { margin: 0.5cm; size: A4; }
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 15px;
      color: #333;
      direction: rtl;
      font-size: 12px;
    }
    .header {
      text-align: center;
      margin-bottom: 15px;
      border-bottom: 2px solid #f97316;
      padding-bottom: 10px;
    }
    .logo { width: 150px; margin: 0 auto 10px; }
    h1 { color: #1e3a8a; font-size: 20px; margin: 5px 0; }
    .summary {
      display: flex;
      gap: 10px;
      margin: 10px 0;
      font-size: 11px;
    }
    .summary-box {
      border: 1px solid #ddd;
      padding: 8px;
      border-radius: 4px;
      flex: 1;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 10px 0;
      font-size: 11px;
    }
    th {
      background: #1e3a8a;
      color: white;
      padding: 6px;
      text-align: right;
      font-size: 11px;
    }
    td {
      padding: 4px 6px;
      border-bottom: 1px solid #eee;
    }
    .employee-name {
      background: #f0f9ff;
      font-weight: bold;
      color: #1e3a8a;
    }
    .subtotal {
      background: #fef3c7;
      font-weight: bold;
      text-align: left;
    }
    .grand-total {
      background: #f97316;
      color: white;
      padding: 10px;
      margin-top: 10px;
      text-align: center;
      font-size: 16px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="header">
    <svg class="logo" viewBox="0 0 200 80" xmlns="http://www.w3.org/2000/svg">
      <path d="M40 15 L60 15 L70 25 L70 55 L30 55 L30 25 Z" fill="none" stroke="#f97316" stroke-width="4"/>
      <text x="85" y="35" font-family="Arial" font-size="24" font-weight="bold" fill="#1e3a8a">Ashley</text>
      <text x="85" y="52" font-family="Arial" font-size="12" fill="#1e3a8a">HOMESTORE</text>
    </svg>
    <h1>ڕاپۆرتی خەرجییەکانی کارمەندان</h1>
    <p style="margin: 0; font-size: 11px;">بەروار: ${new Date().toLocaleDateString('ar-IQ')}</p>
  </div>
  
  <div class="summary">
    <div class="summary-box">کۆی کارمەندان: <strong>${Object.keys(groupedExpenses).length}</strong></div>
    <div class="summary-box">کۆی خەرجییەکان: <strong>${expenses.length}</strong></div>
    <div class="summary-box">کۆی گشتی: <strong>${grandTotal.toLocaleString()} IQD</strong></div>
  </div>

  <table>
    <thead>
      <tr>
        <th>کارمەند</th>
        <th>بەروار</th>
        <th>تێبینی</th>
        <th>بڕ (IQD)</th>
      </tr>
    </thead>
    <tbody>`;

        employeeTotals.forEach(({ name, total }) => {
          html += `<tr class="employee-name"><td colspan="4">${name}</td></tr>`;
          groupedExpenses[name].forEach(expense => {
            html += `
      <tr>
        <td></td>
        <td>${expense.date}</td>
        <td>${expense.note || '-'}</td>
        <td>${expense.amount.toLocaleString()}</td>
      </tr>`;
          });
          html += `<tr class="subtotal"><td colspan="3">کۆی ${name}:</td><td><strong>${total.toLocaleString()}</strong></td></tr>`;
        });

        html += `
    </tbody>
  </table>
  <div class="grand-total">کۆی گشتی: ${grandTotal.toLocaleString()} IQD</div>
</body>
</html>`;

        return html;
      };

      const handleDownload = () => {
        if (expenses.length === 0) {
          alert('هیچ خەرجییەک نییە بۆ داگرتن!');
          return;
        }
        const htmlContent = generateHTMLReport();
        const blob = new Blob([htmlContent], { type: 'text/html' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `ashley-ڕاپۆرت-${new Date().toISOString().split('T')[0]}.html`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        alert('ڕاپۆرتەکە دابەزێنرا!');
      };

      const handlePrintPreview = () => {
        if (expenses.length === 0) {
          alert('هیچ خەرجییەک نییە بۆ چاپکردن!');
          return;
        }
        const htmlContent = generateHTMLReport();
        const printWindow = window.open('', '_blank');
        if (printWindow) {
          printWindow.document.write(htmlContent);
          printWindow.document.close();
          setTimeout(() => printWindow.print(), 500);
        }
      };

      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-orange-50 p-4">
          <div className="max-w-7xl mx-auto">
            <div className="bg-white rounded-lg shadow-lg p-4 mb-4">
              <div className="flex justify-center mb-3">
                <svg width="200" height="80" viewBox="0 0 250 100">
                  <path d="M50 20 L75 20 L90 35 L90 70 L35 70 L35 35 Z" fill="none" stroke="#f97316" strokeWidth="5"/>
                  <text x="105" y="48" fontFamily="Arial" fontSize="32" fontWeight="bold" fill="#1e3a8a">Ashley</text>
                  <text x="105" y="68" fontFamily="Arial" fontSize="14" fill="#1e3a8a">HOMESTORE</text>
                </svg>
              </div>

              <div className="flex justify-between items-center mb-4">
                <h1 className="text-xl font-bold text-blue-900" dir="rtl">شوێنکەوتنی خەرجییەکان</h1>
                <div className="flex gap-2">
                  <button
                    onClick={() => setShowEmployeeModal(true)}
                    className="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition flex items-center gap-2 text-sm"
                  >
                    <Settings size={18} />
                    بەڕێوەبردنی کارمەندان
                  </button>
                  <button
                    onClick={handlePrintPreview}
                    className="bg-blue-900 text-white px-4 py-2 rounded-lg hover:bg-blue-800 transition flex items-center gap-2 text-sm"
                  >
                    <Printer size={18} />
                    چاپ
                  </button>
                  <button
                    onClick={handleDownload}
                    className="bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition flex items-center gap-2 text-sm"
                  >
                    <Download size={18} />
                    داگرتن
                  </button>
                </div>
              </div>

              <div className="bg-gray-50 rounded-lg p-3 mb-3">
                <div className="grid grid-cols-5 gap-2">
                  <select
                    value={formData.employeeName}
                    onChange={(e) => setFormData({...formData, employeeName: e.target.value})}
                    className="px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-orange-500"
                    dir="rtl"
                  >
                    <option value="">کارمەند</option>
                    {employees.map(emp => (
                      <option key={emp} value={emp}>{emp}</option>
                    ))}
                  </select>
                  
                  <input
                    type="date"
                    value={formData.date}
                    onChange={(e) => setFormData({...formData, date: e.target.value})}
                    className="px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-orange-500"
                  />
                  
                  <input
                    type="number"
                    step="1"
                    placeholder="بڕ (IQD)"
                    value={formData.amount}
                    onChange={(e) => setFormData({...formData, amount: e.target.value})}
                    className="px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-orange-500"
                    dir="rtl"
                  />
                  
                  <input
                    type="text"
                    placeholder="تێبینی"
                    value={formData.note}
                    onChange={(e) => setFormData({...formData, note: e.target.value})}
                    className="px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-orange-500"
                    dir="rtl"
                  />
                  
                  <button
                    onClick={handleSubmit}
                    className="bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 transition flex items-center justify-center gap-1 text-sm"
                  >
                    <Plus />
                    زیادکردن
                  </button>
                </div>
              </div>

              <div className="grid grid-cols-3 gap-2">
                <div className="bg-blue-50 p-2 rounded border border-blue-200" dir="rtl">
                  <p className="text-xs text-gray-600">کارمەندان</p>
                  <p className="text-lg font-bold text-blue-900">{Object.keys(groupedExpenses).length}</p>
                </div>
                <div className="bg-green-50 p-2 rounded border border-green-200" dir="rtl">
                  <p className="text-xs text-gray-600">خەرجییەکان</p>
                  <p className="text-lg font-bold text-green-600">{expenses.length}</p>
                </div>
                <div className="bg-orange-50 p-2 rounded border border-orange-200" dir="rtl">
                  <p className="text-xs text-gray-600">کۆی گشتی</p>
                  <p className="text-lg font-bold text-orange-600">{grandTotal.toLocaleString()} IQD</p>
                </div>
              </div>
            </div>

            {employeeTotals.length > 0 ? (
              <div className="bg-white rounded-lg shadow-lg p-4">
                <table className="w-full text-sm">
                  <thead className="bg-blue-900 text-white">
                    <tr dir="rtl">
                      <th className="px-3 py-2 text-right">کارمەند</th>
                      <th className="px-3 py-2 text-right">بەروار</th>
                      <th className="px-3 py-2 text-right">بڕ (IQD)</th>
                      <th className="px-3 py-2 text-right">تێبینی</th>
                      <th className="px-3 py-2 text-center w-16"></th>
                    </tr>
                  </thead>
                  <tbody>
                    {employeeTotals.map(({ name, total }) => (
                      <React.Fragment key={name}>
                        {groupedExpenses[name].map((expense, idx) => (
                          <tr key={expense.id} className="border-b hover:bg-gray-50" dir="rtl">
                            {idx === 0 ? (
                              <td className="px-3 py-2 font-bold text-blue-900 bg-blue-50" rowSpan={groupedExpenses[name].length + 1}>
                                {name}
                              </td>
                            ) : null}
                            <td className="px-3 py-2 text-gray-600">{expense.date}</td>
                            <td className="px-3 py-2 font-semibold">{expense.amount.toLocaleString()}</td>
                            <td className="px-3 py-2 text-gray-600">{expense.note || '-'}</td>
                            <td className="px-3 py-2 text-center">
                              <button
                                onClick={() => deleteExpense(expense.id)}
                                className="text-red-500 hover:text-red-700 p-1"
                              >
                                <Trash2 size={16} />
                              </button>
                            </td>
                          </tr>
                        ))}
                        <tr className="bg-orange-50 font-bold" dir="rtl">
                          <td className="px-3 py-2" colSpan="3">کۆی {name}: {total.toLocaleString()} IQD</td>
                          <td></td>
                        </tr>
                      </React.Fragment>
                    ))}
                    <tr className="bg-orange-500 text-white font-bold text-lg" dir="rtl">
                      <td className="px-3 py-3 text-center" colSpan="5">
                        کۆی گشتی: {grandTotal.toLocaleString()} IQD
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            ) : (
              <div className="bg-white rounded-lg shadow-lg p-8 text-center">
                <p className="text-gray-500" dir="rtl">هیچ خەرجییەک نییە</p>
              </div>
            )}
          </div>

          {showEmployeeModal && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
              <div className="bg-white rounded-lg shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-y-auto">
                <div className="p-6">
                  <div className="flex justify-between items-center mb-4" dir="rtl">
                    <h2 className="text-2xl font-bold text-blue-900">بەڕێوەبردنی کارمەندان</h2>
                    <button
                      onClick={() => setShowEmployeeModal(false)}
                      className="text-gray-500 hover:text-gray-700"
                    >
                      <X size={24} />
                    </button>
                  </div>

                  <div className="mb-4">
                    <div className="flex gap-2" dir="rtl">
                      <input
                        type="text"
                        placeholder="ناوی کارمەندی نوێ"
                        value={newEmployeeName}
                        onChange={(e) => setNewEmployeeName(e.target.value)}
                        onKeyPress={(e) => e.key === 'Enter' && handleAddEmployee()}
                        className="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      />
                      <button
                        onClick={handleAddEmployee}
                        className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2"
                      >
                        <UserPlus size={20} />
                        زیادکردن
                      </button>
                    </div>
                  </div>

                  <div className="border rounded-lg p-4">
                    <h3 className="font-bold mb-3 text-gray-700" dir="rtl">لیستی کارمەندان ({employees.length})</h3>
                    <div className="space-y-2">
                      {employees.length === 0 ? (
                        <p className="text-center text-gray-500 py-4" dir="rtl">هیچ کارمەندێک نییە</p>
                      ) : (
                        employees.map(emp => (
                          <div key={emp} className="flex justify-between items-center bg-gray-50 p-3 rounded-lg" dir="rtl">
                            <span className="font-medium">{emp}</span>
                            <button
                              onClick={() => handleRemoveEmployee(emp)}
                              className="text-red-500 hover:text-red-700 flex items-center gap-1"
                            >
                              <Trash2 size={18} />
                              <span className="text-sm">سڕینەوە</span>
                            </button>
                          </div>
                        ))
                      )}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    }

    ReactDOM.render(<ExpenseTracker />, document.getElementById('root'));
  </script>
</body>
</html># ---
